Agent Tesla Malware Analysis  FTP & SMTP Exfiltration

Project Overview
This project focuses on analyzing **Agent Tesla malware traffic** using Wireshark, with two infection scenarios:
1. FTP-based data exfiltration 
3. SMTP-based data exfiltration  

Both cases show how malware can abuse common services (FTP, email) to steal sensitive data while leaving identifiable traces in network traffic.

Tools & Environment
- Wireshark â€“ Packet capture analysis  
- WHOIS & IP reputation checks â€“ Infrastructure validation  

Key Findings
Case 1: FTP Exfiltration
- Infected host (10.1.31.101) connected to external FTP server 93.89.225.40.  
- Plaintext credentials observed (USER/PASS).  
- Client issued "STOR command", uploading:  
  `PW_daviv.miller-DESKTOP-WE9H2FM_2025-01_31_20_24_25.html`  
- Server responded "226 Transfer completed", confirming successful upload.  
- WHOIS flagged the FTP server as suspicious.  

Case 2: SMTP Exfiltration
- Infected host (10.1.31.101) connected to SMTP server 208.91.198.143 (`us2.outbound.mailhostbox.com`).  
- AUTH PLAIN with base64 credentials observed â†’ login successful.  
- MAIL FROM / RCPT TO: `director@igakuin.com` (attacker-controlled).  
- DATA block contained base64-encoded stolen data as an email attachment.  
- Server responded 250 OK, confirming delivery.  

Indicators of Compromise (IOCs)
FTP Case 
- Attacker IP: `93.89.225.40`  
- Service: Microsoft FTP Service (may be spoofed)  
- Credentials: Random USER/PASS observed  
- Exfiltrated file: HTML with host/user/timestamp naming  
SMTP Case  
- Attacker IP:
-  `208.91.198.143`  
- Hostname: `us2.outbound.mailhostbox.com`  
- Sender/Recipient: `director@igakuin.com`  
- Protocol: SMTP with AUTH PLAIN, base64-encoded attachment  

## ðŸš¨ Incident Response
- Identification: Suspicious outbound FTP/SMTP traffic detected.  
- Containment: Blocked malicious IPs; disconnected infected host.  
- Eradication: Removed persistence mechanisms; malware cleanup.  
- Recovery: Restored host from backup; rotated credentials; deployed monitoring rules.  

 Reports
- [Agent Tesla FTP Exfiltration Report (PDF)](../Agent_Tesla_FTP_Report.pdf)  
- [Agent Tesla SMTP Exfiltration Report (PDF)](../Agent_Tesla_SMTP_Report.pdf)  

Key Takeaways
- Malware can hide in legitimate services like FTP or SMTP.  
- Network traffic often exposes credentials, commands, and server confirmations that reveal exfiltration.  
- Careful packet analysis and IOC extraction are key for SOC Analysts to detect and respond quickly.

